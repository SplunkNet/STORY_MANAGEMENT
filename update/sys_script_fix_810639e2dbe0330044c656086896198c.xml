<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_script_fix">
    <sys_script_fix action="INSERT_OR_UPDATE">
        <active>true</active>
        <before>false</before>
        <description>Assign Stories To Group Members</description>
        <flush_cache>false</flush_cache>
        <name>AssignStories</name>
        <record_for_rollback>false</record_for_rollback>
        <run_once>true</run_once>
        <script><![CDATA[execute();

function execute(){
	var group = new GlideRecord('sys_user_group');
	group.get('name','ServiceNow Developers');

	var groupMembers = new GlideRecord('sys_user_grmember');
	groupMembers.addQuery('group', group.getUniqueValue());
	groupMembers.query();
	groupMembers.next();
	
	//while(groupMembers.next()){
	for(i=0; i<5; i++){
		assignToUser(groupMembers.user.sys_id);
	}
	//}
}

function assignToUser(user) {
	var choice = new GlideRecord('sys_choice');
	choice.addQuery('name','x_254768_sm_story');
	choice.query();
	
	randomChoice = getRandomValue(choice);
	
	var groupOfUser = new GlideRecord('sys_user_grmember');
	groupOfUser.get('user', user);
	
	var createStory = new GlideRecord('x_254768_sm_story');
	createStory.newRecord();
	createStory.setValue('assignment_group', groupOfUser.group.sys_id);
	createStory.setValue('assigned_to', user);
	createStory.setValue('state',randomChoice.value);
	createStory.insert();


}

function getRandomValue(object){
	var numRecs = object.getRowCount();
	gs.info('number of records ' +numRecs);
	var randomNumber = Math.floor(Math.random()*numRecs);
	gs.info('random number ' + randomNumber);

	for(i=0; i<=randomNumber; i++){
		object.next();
	}

	return object;
}]]></script>
        <sys_class_name>sys_script_fix</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2019-04-04 14:19:55</sys_created_on>
        <sys_id>810639e2dbe0330044c656086896198c</sys_id>
        <sys_mod_count>15</sys_mod_count>
        <sys_name>AssignStories</sys_name>
        <sys_package display_value="STORY MANAGEMENT" source="x_254768_sm">47360feddbac330044c6560868961976</sys_package>
        <sys_policy/>
        <sys_scope display_value="STORY MANAGEMENT">47360feddbac330044c6560868961976</sys_scope>
        <sys_update_name>sys_script_fix_810639e2dbe0330044c656086896198c</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2019-04-04 15:16:43</sys_updated_on>
        <unloadable>false</unloadable>
    </sys_script_fix>
</record_update>
